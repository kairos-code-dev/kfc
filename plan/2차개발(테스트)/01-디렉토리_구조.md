# 테스트 디렉토리 구조

## 전체 디렉토리 구조

```
kfc/
├── src/
│   ├── main/kotlin/dev/kairoscode/kfc/
│   │   ├── api/
│   │   │   ├── EtfApi.kt
│   │   │   └── CorpApi.kt
│   │   ├── internal/
│   │   │   ├── krx/
│   │   │   ├── naver/
│   │   │   └── opendart/
│   │   ├── model/
│   │   ├── exception/
│   │   └── KfcClient.kt
│   │
│   ├── liveTest/                                    # ← 신규 생성
│   │   └── kotlin/dev/kairoscode/kfc/
│   │       ├── utils/                               # 헬퍼 클래스
│   │       │   ├── LiveTestBase.kt                 # Live Test 기본 클래스
│   │       │   ├── ResponseRecorder.kt             # 응답 레코더
│   │       │   ├── RecordingConfig.kt              # 레코딩 설정
│   │       │   └── TestSymbols.kt                  # 테스트용 심볼 상수
│   │       │
│   │       └── live/                                # Live Test 파일
│   │           ├── etf/                             # EtfApi Live Test
│   │           │   ├── EtfListLiveTest.kt
│   │           │   ├── EtfComprehensiveLiveTest.kt
│   │           │   ├── EtfDailyPricesLiveTest.kt
│   │           │   ├── EtfOhlcvLiveTest.kt
│   │           │   ├── EtfAdjustedOhlcvLiveTest.kt
│   │           │   ├── EtfPriceChangesLiveTest.kt
│   │           │   ├── EtfPortfolioLiveTest.kt
│   │           │   ├── EtfPerformanceLiveTest.kt    # TrackingError, DivergenceRate
│   │           │   ├── EtfInvestorTradingLiveTest.kt
│   │           │   └── EtfShortLiveTest.kt          # ShortSelling, ShortBalance
│   │           │
│   │           └── corp/                            # CorpApi Live Test
│   │               ├── CorpCodeLiveTest.kt
│   │               ├── DividendLiveTest.kt
│   │               ├── StockSplitLiveTest.kt
│   │               └── DisclosureLiveTest.kt
│   │
│   ├── test/                                        # ← 기존 확장
│   │   ├── kotlin/dev/kairoscode/kfc/
│   │   │   ├── utils/                               # 헬퍼 클래스
│   │   │   │   ├── UnitTestBase.kt                 # Unit Test 기본 클래스
│   │   │   │   ├── MockHttpClientFactory.kt        # Mock HTTP Client 팩토리
│   │   │   │   ├── JsonResponseLoader.kt           # JSON 파일 로더
│   │   │   │   └── TestExtensions.kt               # 테스트 확장 함수
│   │   │   │
│   │   │   └── api/                                 # Unit Test 파일
│   │   │       ├── etf/                             # EtfApi Unit Test
│   │   │       │   ├── EtfListApiSpec.kt
│   │   │       │   ├── EtfComprehensiveApiSpec.kt
│   │   │       │   ├── EtfDailyPricesApiSpec.kt
│   │   │       │   ├── EtfOhlcvApiSpec.kt
│   │   │       │   ├── EtfAdjustedOhlcvApiSpec.kt
│   │   │       │   ├── EtfPriceChangesApiSpec.kt
│   │   │       │   ├── EtfPortfolioApiSpec.kt
│   │   │       │   ├── EtfTrackingErrorApiSpec.kt
│   │   │       │   ├── EtfDivergenceRateApiSpec.kt
│   │   │       │   ├── EtfInvestorTradingApiSpec.kt
│   │   │       │   └── EtfShortApiSpec.kt
│   │   │       │
│   │   │       └── corp/                            # CorpApi Unit Test
│   │   │           ├── CorpCodeApiSpec.kt
│   │   │           ├── DividendApiSpec.kt
│   │   │           ├── StockSplitApiSpec.kt
│   │   │           └── DisclosureApiSpec.kt
│   │   │
│   │   └── resources/                               # 테스트 리소스
│   │       └── responses/                           # 레코딩된 API 응답
│   │           ├── etf/
│   │           │   ├── list/
│   │           │   │   ├── etf_list.json
│   │           │   │   └── etf_list_empty.json
│   │           │   │
│   │           │   ├── comprehensive/
│   │           │   │   ├── tiger200.json
│   │           │   │   ├── kodex200.json
│   │           │   │   └── not_found.json
│   │           │   │
│   │           │   ├── daily_prices/
│   │           │   │   ├── all_etf_20241201.json
│   │           │   │   └── all_etf_empty.json
│   │           │   │
│   │           │   ├── ohlcv/
│   │           │   │   ├── tiger200_2024q1.json
│   │           │   │   ├── tiger200_1year.json
│   │           │   │   └── kodex200_6months.json
│   │           │   │
│   │           │   ├── adjusted_ohlcv/
│   │           │   │   ├── 069500_2024q1.json       # TIGER 200
│   │           │   │   ├── 069500_1year.json
│   │           │   │   └── 069500_empty.json
│   │           │   │
│   │           │   ├── price_changes/
│   │           │   │   ├── period_1month.json
│   │           │   │   └── period_1year.json
│   │           │   │
│   │           │   ├── portfolio/
│   │           │   │   ├── tiger200_portfolio.json
│   │           │   │   └── kodex200_portfolio.json
│   │           │   │
│   │           │   ├── tracking_error/
│   │           │   │   ├── tiger200_1month.json
│   │           │   │   └── tiger200_3months.json
│   │           │   │
│   │           │   ├── divergence_rate/
│   │           │   │   ├── tiger200_1month.json
│   │           │   │   └── tiger200_3months.json
│   │           │   │
│   │           │   ├── investor_trading/
│   │           │   │   ├── all_etf_20241201.json
│   │           │   │   ├── all_etf_period.json
│   │           │   │   ├── tiger200_20241201.json
│   │           │   │   └── tiger200_period.json
│   │           │   │
│   │           │   └── short/
│   │           │       ├── tiger200_short_selling.json
│   │           │       └── tiger200_short_balance.json
│   │           │
│   │           └── corp/
│   │               ├── corp_code/
│   │               │   └── corp_code_list.json       # 전체 법인 목록
│   │               │
│   │               ├── dividend/
│   │               │   ├── samsung_2024.json         # 삼성전자 배당
│   │               │   ├── kakao_2024.json           # 카카오 배당
│   │               │   └── empty_response.json
│   │               │
│   │               ├── stock_split/
│   │               │   ├── samsung_2024.json
│   │               │   └── empty_response.json
│   │               │
│   │               └── disclosure/
│   │                   ├── samsung_1month.json       # 삼성전자 1개월 공시
│   │                   ├── all_corp_1day.json        # 전체 법인 1일 공시
│   │                   └── empty_response.json
│   │
│   └── liveTest/resources/                          # Live Test 전용 리소스
│       └── test-api-keys.properties.example         # API 키 예제 파일
│
├── build.gradle.kts
├── local.properties                                  # API 키 저장 (gitignore)
└── .gitignore
```

## 디렉토리별 설명

### 1. `src/liveTest/`

Live Test 소스 디렉토리입니다. 실제 API를 호출하고 응답을 레코딩합니다.

#### `src/liveTest/kotlin/dev/kairoscode/kfc/utils/`

Live Test를 위한 공통 헬퍼 클래스들입니다.

- **LiveTestBase.kt**: 모든 Live Test의 부모 클래스
- **ResponseRecorder.kt**: API 응답을 JSON 파일로 저장
- **RecordingConfig.kt**: 레코딩 설정 및 경로 관리
- **TestSymbols.kt**: 테스트용 ETF/종목 코드 상수

#### `src/liveTest/kotlin/dev/kairoscode/kfc/live/`

실제 Live Test 파일들입니다. API별로 디렉토리를 구분합니다.

### 2. `src/test/`

Unit Test 소스 디렉토리입니다. Mock HTTP Client를 사용합니다.

#### `src/test/kotlin/dev/kairoscode/kfc/utils/`

Unit Test를 위한 공통 헬퍼 클래스들입니다.

- **UnitTestBase.kt**: 모든 Unit Test의 부모 클래스
- **MockHttpClientFactory.kt**: Mock HTTP Client 생성 팩토리
- **JsonResponseLoader.kt**: JSON 파일을 로드하는 유틸리티
- **TestExtensions.kt**: 테스트용 확장 함수 (assert 헬퍼 등)

#### `src/test/kotlin/dev/kairoscode/kfc/api/`

실제 Unit Test 파일들입니다. API별로 디렉토리를 구분합니다.

### 3. `src/test/resources/responses/`

Live Test에서 레코딩한 JSON 응답 파일들입니다.

- API별로 디렉토리 구분
- 함수별로 하위 디렉토리 생성
- 파일명은 테스트 케이스를 명확히 표현

### 4. `local.properties`

API 키를 저장하는 파일입니다 (gitignore 필수).

```properties
# OPENDART API Key (필수)
OPENDART_API_KEY=your-api-key-here

# KRX, Naver API는 별도 키 불필요
```

## 디렉토리 생성 명령어

```bash
# Live Test 디렉토리 구조 생성
mkdir -p src/liveTest/kotlin/dev/kairoscode/kfc/utils
mkdir -p src/liveTest/kotlin/dev/kairoscode/kfc/live/etf
mkdir -p src/liveTest/kotlin/dev/kairoscode/kfc/live/corp

# Unit Test 디렉토리 구조 생성 (이미 존재할 수 있음)
mkdir -p src/test/kotlin/dev/kairoscode/kfc/utils
mkdir -p src/test/kotlin/dev/kairoscode/kfc/api/etf
mkdir -p src/test/kotlin/dev/kairoscode/kfc/api/corp

# Test Resources 디렉토리 구조 생성
mkdir -p src/test/resources/responses/etf/list
mkdir -p src/test/resources/responses/etf/comprehensive
mkdir -p src/test/resources/responses/etf/daily_prices
mkdir -p src/test/resources/responses/etf/ohlcv
mkdir -p src/test/resources/responses/etf/adjusted_ohlcv
mkdir -p src/test/resources/responses/etf/price_changes
mkdir -p src/test/resources/responses/etf/portfolio
mkdir -p src/test/resources/responses/etf/tracking_error
mkdir -p src/test/resources/responses/etf/divergence_rate
mkdir -p src/test/resources/responses/etf/investor_trading
mkdir -p src/test/resources/responses/etf/short

mkdir -p src/test/resources/responses/corp/corp_code
mkdir -p src/test/resources/responses/corp/dividend
mkdir -p src/test/resources/responses/corp/stock_split
mkdir -p src/test/resources/responses/corp/disclosure
```

## 파일 개수 예상

| 구분 | 파일 개수 | 비고 |
|------|----------|------|
| Live Test 파일 | 14개 | EtfApi 10개 + CorpApi 4개 |
| Unit Test 파일 | 14개 | EtfApi 10개 + CorpApi 4개 |
| 헬퍼 클래스 (Live) | 4개 | Base, Recorder, Config, Symbols |
| 헬퍼 클래스 (Unit) | 4개 | Base, Factory, Loader, Extensions |
| JSON 응답 파일 | 50-100개 | 함수별 2-10개 예상 |
| **총계** | **86-136개** | |

## 다음 단계

1. ✅ 디렉토리 생성 실행
2. ✅ 헬퍼 클래스 작성 → `02-헬퍼_클래스_작성_가이드.md` 참고
3. ✅ 각 API별 테스트 작성 → `03-EtfApi_테스트_계획.md`, `04-CorpApi_테스트_계획.md` 참고
